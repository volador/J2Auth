<?xml version="1.0" encoding="UTF-8"?>
<beans>
	<!-- 总控制器 -->
	<bean name="authManager" class="org.j2auth.main.AuthManager">
		<map-ref name="authFilters" type="org.j2auth.main.AuthFilter">
			<entry name="cookieVerifier" ref="cookieVerifier"/>
			<entry name="anonymousVerifier" ref="anonymousVerifier"/>
			<entry name="formLogin" ref="formLoginChecker"/>
			<entry name="logout" ref="logoutProcesser"/>
			<entry name="checkPointProcesser" ref="checkPointProcesser"/>
			<entry name="judger" ref="judgeProcesser"/>
		</map-ref>
	</bean>
	
	<!-- 表单登录 -->
	<bean name="formLoginChecker" class="org.j2auth.filters.pass.FormLoginChecker">
		<ref name="userService" type="org.j2auth.filters.UserService"/>
	</bean>
	
	<!-- 请求判决 -->
	<bean name="judgeProcesser" class="org.j2auth.filters.JudgeProcesser">
		<string name="loginPage" value="Login"/>
		<string name="forbidenPage" value="forbiden"/>
	</bean>
	
	<!-- checkpoint管理器 -->
	<bean name="checkPointProcesser" class="org.j2auth.filters.CheckPointProcesser">
		<ref name="userService" type="org.j2auth.filters.UserService"/>
		<list-string name="openSource">
			<value value="/[lL]ogin*"/>
			<value value="/forbiden*"/>
			<value value="/Home*"/>
		</list-string>
	</bean>

	<!-- cookie验证 -->	
	<bean name="cookieVerifier" class="org.j2auth.filters.CookieVerifier">
		<ref name="decoder" type="org.j2auth.util.Decoder"/>
		<!-- 用户实现 -->
		<ref name="userService" type="org.j2auth.filters.UserService"/>
	</bean>
	
	<!-- cookie解密器 -->
	<bean name="decoder" class="org.j2auth.util.SimpleDecoder"/>
	
	<!-- 处理匿名登录 -->
	<bean name="anonymousVerifier" class="org.j2auth.filters.AnonymousVerifier"/>
	
	<!-- 登出处理 -->
	<bean name="logoutProcesser" class="org.j2auth.filters.pass.LogoutProcesser">
		<string name="redirect" value="http://www.baidu.com"/>
	</bean>
	
	<bean name="userService" class="org.j2auth.filters.UserServiceImpl"/>
</beans>